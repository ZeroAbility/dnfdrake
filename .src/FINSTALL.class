' Gambas class file

$TXTRPMPATH As String
Public $SECURE As Integer

Public Sub Form_Open()

 Dim flTTP As File  
 Dim jTTP As Byte
 Dim s$TTP As String
 Dim ss$TTP As New String[]
 flTTP = Open "/usr/share/dnfdrake/dnfdrake-TTP-" & Fmain.$LANG For Read   ' ...oppure "Input"
 While Not Eof(flTTP)
   Input #flTTP, s$TTP
' ' Poich√© "Input" legge le stringhe in un File di testo fino all'interruzione dello spazio o al carattere di "nuova linea",
' ' ogni parola del testo, delimitata da uno spazio, viene individuata e caricata in un nuovo elemento della variabile-array ss$:
   ss$TTP.Add(s$TTP)
  Wend
   Close #flTTP
' ' Scrive i nomi dei pulsanti nella lingua di sistema usando ogni stringa contenuta in ciascun elemento della variabile-array ss$:
  For jTTP = 0 To ss$TTP.Max
      $TXTRPMPATH = Replace(ss$TTP[50], "_", " ")
     Next
   flTTP.Close
 '*********************************************************************************

BTNINSTALL.Text = Fmain.btninstall.Text
BTNANNULLA.Text = Fmain.btnstop.Text   
BTNPKGUPDATE.Text = Fmain.BTNPKGUPDATE.Text  
BTNPKGREINSTALL.Text = Fmain.BTNREINSTALL.Text  
TXTRPMPATH.Text = $TXTRPMPATH & Right(Fmain.$RPMPATH, "-" & RInStr(Fmain.$RPMPATH, "/")) & " ?"
If Fmain.$SECUREMODE = "SECURE" Then
  Fmain.Enabled = False  
Endif
$SECURE = 0
End


Public Sub BTNANNULLA_Click()

  Fmain.$RPMPATH = ""
  Fmain.txtpkg.Text = ""
  If Fmain.$OFFLINE = 1 Then
    Fmain.TimerUPLISTE.Enabled = True
  Endif
  $SECURE = 1
  Fmain.Enabled = True
  Me.Close
End

Public Sub BTNINSTALL_Click()
  BTNINSTALL.Enabled = False
  $SECURE = 1
  Fmain.$RPMPATH = ""
  Fmain.BTNINSTALL_CLICK
  Me.Close
End

Public Sub TXTRPMPATH_MouseDown()
End

Public Sub BTNPKGUPDATE_Click()
  BTNPKGUPDATE.Enabled = False
  $SECURE = 1
  Fmain.$RPMPATH = ""
  Fmain.BTNPKGUPDATE_Click
  Me.Close
End

Public Sub BTNPKGREINSTALL_Click()
  BTNPKGREINSTALL.Enabled = False
  $SECURE = 1
  Fmain.$RPMPATH = ""
  Fmain.BTNREINSTALL_CLICK
  Me.Close
End

Public Sub Form_Close()
If $SECURE = 1 Then
Else 
  BTNANNULLA_Click
Endif

End

